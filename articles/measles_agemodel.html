<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Measles Age-Structured Model • multigroup.vaccine</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Measles Age-Structured Model">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">multigroup.vaccine</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Measles Age-Structured Model</h1>
            
      

      <div class="d-none name"><code>measles_agemodel.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://epiforesite.github.io/multigroup-vaccine/">multigroup.vaccine</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/epiforecasts/socialmixr" class="external-link">socialmixr</a></span><span class="op">)</span></span></code></pre></div>
<p>This vignette demonstrates how to build and run an age-structured
model of transmission within a U.S. county. The example is an outbreak
of measles in Washington County, Utah.</p>
<p>First we define the age groups that we want use in our model. Here we
choose groupings for which we might have reason to assume different
levels of immunization against measles. We define the
<code>age_limits</code> vector using the lower limit (minimum age) of
each group, starting with 0:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># under 1, 1-4, 5-11, 12-17, 18-24, 25-44, 45-69, 70 plus</span></span>
<span><span class="va">age_limits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">5</span>, <span class="fl">12</span>, <span class="fl">18</span>, <span class="fl">25</span>, <span class="fl">45</span>, <span class="fl">70</span><span class="op">)</span></span></code></pre></div>
<p>Next we collect census data from Washington County, Utah, using our
custom age group choice:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get data for Washington County, Utah</span></span>
<span><span class="va">washington_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getCensusData.html">getCensusData</a></span><span class="op">(</span></span>
<span>  state_fips <span class="op">=</span> <span class="fu"><a href="../reference/getStateFIPS.html">getStateFIPS</a></span><span class="op">(</span><span class="st">"Utah"</span><span class="op">)</span>,</span>
<span>  county_name <span class="op">=</span> <span class="st">"Washington County"</span>,</span>
<span>  year <span class="op">=</span> <span class="fl">2024</span>,</span>
<span>  age_groups <span class="op">=</span> <span class="va">age_limits</span>,</span>
<span>  csv_path <span class="op">=</span> <span class="fu"><a href="../reference/getCensusDataPath.html">getCensusDataPath</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Now we specify immunity levels of our population age groups due to
vaccination. The first age group (under 1 year) has no immunity because
the first measles vaccine is not given until age one. Then we assume
rising immunity with age:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">age_immunity</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.77</span>, <span class="fl">0.83</span>, <span class="fl">0.85</span>, <span class="fl">0.87</span>, <span class="fl">0.90</span>, <span class="fl">0.92</span>, <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>Now we can begin defining the input arguments to our
<code>finalsize</code> function so that we can estimate the measles
outbreak size in this county after an introduction.</p>
<p>Initial population size of each state:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">popsize</span> <span class="op">&lt;-</span> <span class="va">washington_data</span><span class="op">$</span><span class="va">age_pops</span></span>
<span></span>
<span><span class="va">initV</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">age_immunity</span> <span class="op">*</span> <span class="va">popsize</span><span class="op">)</span>  <span class="co"># initially immune cases </span></span>
<span></span>
<span><span class="va">initI</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">popsize</span><span class="op">)</span><span class="op">)</span>  <span class="co"># initial infectious cases</span></span>
<span><span class="va">initI</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span>                     <span class="co"># assume 1 initial case in the 6th age group (25-44)</span></span>
<span></span>
<span><span class="va">initR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">popsize</span><span class="op">)</span><span class="op">)</span>  <span class="co"># no recent prior measles outbreaks</span></span></code></pre></div>
<p>Transmission matrix ingredients: contact matrix, relative
susceptibility and transmissibility, and the basic reproduction number
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mn>0</mn></msub><annotation encoding="application/x-tex">R_0</annotation></semantics></math>).
The contact matrix uses Polymod contact survey data, adjusted for local
population distribution:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">contactmatrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/contactMatrixPolymod.html">contactMatrixPolymod</a></span><span class="op">(</span><span class="va">age_limits</span>, <span class="va">popsize</span><span class="op">)</span></span>
<span><span class="va">relsusc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">popsize</span><span class="op">)</span><span class="op">)</span>      <span class="co"># Assume no age differences in susceptibility</span></span>
<span><span class="va">reltransm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">popsize</span><span class="op">)</span><span class="op">)</span>    <span class="co"># or transmissibility per contact</span></span>
<span><span class="va">R0</span> <span class="op">&lt;-</span> <span class="fl">10</span></span></code></pre></div>
<p>Now we can estimate the final size of an outbreak using the default,
deterministic solution produced by the <code><a href="../reference/finalsize.html">finalsize()</a></code>
function:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/finalsize.html">finalsize</a></span><span class="op">(</span><span class="va">popsize</span>, <span class="va">R0</span>, <span class="va">contactmatrix</span>, <span class="va">relsusc</span>, <span class="va">reltransm</span>, <span class="va">initR</span>, <span class="va">initI</span>, <span class="va">initV</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">fs</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 7573</span></span></code></pre></div>
<p>Under the model assumptions and with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mn>0</mn></msub><annotation encoding="application/x-tex">R_0</annotation></semantics></math>
= 10, there could be an outbreak of more than 7,500 measles cases in
this county.</p>
<p>Here’s how the outbreak size looks for each age group:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">fs</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">washington_data</span><span class="op">$</span><span class="va">age_labels</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">fs</span><span class="op">)</span></span>
<span><span class="co">#&gt; under1   1to4  5to11 12to17 18to24 25to44 45to69 70plus </span></span>
<span><span class="co">#&gt;    372    648   1673   1748    876   1414    843      0</span></span></code></pre></div>
<p>Here’s an example using the “hybrid” method option in the
<code><a href="../reference/finalsize.html">finalsize()</a></code> function, which runs stochastic simulations
from the initial conditions until the outbreak dies out or reaches an
“escape” threshold, after which the stochastic simulation is suspended
and replaced with the deterministic solution above.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fs_hybrid</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/finalsize.html">finalsize</a></span><span class="op">(</span><span class="va">popsize</span>, <span class="va">R0</span>, <span class="va">contactmatrix</span>, <span class="va">relsusc</span>, <span class="va">reltransm</span>, <span class="va">initR</span>, <span class="va">initI</span>, <span class="va">initV</span>, method <span class="op">=</span> <span class="st">"hybrid"</span>, nsims <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">fs_hybrid</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">washington_data</span><span class="op">$</span><span class="va">age_labels</span></span>
<span><span class="va">fs_hybrid</span></span>
<span><span class="co">#&gt;       under1 1to4 5to11 12to17 18to24 25to44 45to69 70plus</span></span>
<span><span class="co">#&gt;  [1,]      0    0     0      0      0      1      0      0</span></span>
<span><span class="co">#&gt;  [2,]      0    0     0      1      4      3      0      0</span></span>
<span><span class="co">#&gt;  [3,]      0    0     0      0      0      1      0      0</span></span>
<span><span class="co">#&gt;  [4,]      0    0     0      0      0      1      0      0</span></span>
<span><span class="co">#&gt;  [5,]      0    0     0      0      0      1      0      0</span></span>
<span><span class="co">#&gt;  [6,]      4    0     0      7      0      1      1      0</span></span>
<span><span class="co">#&gt;  [7,]      0    0     0      0      0      1      0      0</span></span>
<span><span class="co">#&gt;  [8,]    372  648  1673   1748    876   1414    843      0</span></span>
<span><span class="co">#&gt;  [9,]      0    0     0      0      0      1      0      0</span></span>
<span><span class="co">#&gt; [10,]      0    0     0      0      0      1      0      0</span></span>
<span><span class="co">#&gt; [11,]      0    0     0      0      0      1      0      0</span></span>
<span><span class="co">#&gt; [12,]      0    0     0      0      0      1      0      0</span></span>
<span><span class="co">#&gt; [13,]      0    0     0      0      0      1      0      0</span></span>
<span><span class="co">#&gt; [14,]      0    0     0      1      1      4      0      0</span></span>
<span><span class="co">#&gt; [15,]      1    0     0      0      0      1      1      0</span></span>
<span><span class="co">#&gt; [16,]    372  648  1673   1748    876   1414    843      0</span></span>
<span><span class="co">#&gt; [17,]      0    0     0      0      0      1      0      0</span></span>
<span><span class="co">#&gt; [18,]      1    2     2      0      0      4      0      0</span></span>
<span><span class="co">#&gt; [19,]      0    0     0      0      0      1      0      0</span></span>
<span><span class="co">#&gt; [20,]    372  648  1673   1748    876   1414    843      0</span></span>
<span><span class="co">#&gt; [21,]      4    2     5      1      3      8      2      0</span></span>
<span><span class="co">#&gt; [22,]      0    0     0      0      0      2      0      0</span></span>
<span><span class="co">#&gt; [23,]      0    2     1      0      0      1      0      0</span></span>
<span><span class="co">#&gt; [24,]      0    0     0      0      0      1      0      0</span></span>
<span><span class="co">#&gt; [25,]    372  648  1673   1748    876   1414    843      0</span></span>
<span><span class="co">#&gt; [26,]      0    0     0      0      0      2      0      0</span></span>
<span><span class="co">#&gt; [27,]    372  648  1673   1748    876   1414    843      0</span></span>
<span><span class="co">#&gt; [28,]      0    0     0      0      2      2      0      0</span></span>
<span><span class="co">#&gt; [29,]      0    0     0      0      0      1      0      0</span></span>
<span><span class="co">#&gt; [30,]      0    0     0      0      0      1      0      0</span></span></code></pre></div>
<p>The results show that not every introduction of one infectious
individual (in the 25 to 44 age group) will lead to a large
outbreak.</p>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Damon Toth, Jake Wagoner, Centers for Disease Control and Prevention’s Center for Forecasting and Outbreak Analytics.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
