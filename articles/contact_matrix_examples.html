<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Contact Matrix Examples • multigroup.vaccine</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Contact Matrix Examples">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">multigroup.vaccine</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/combined_cities.html">Combined City Population: Measles Outbreak Modeling</a></li>
    <li><a class="dropdown-item" href="../articles/contact_matrix_examples.html">Contact Matrix Examples</a></li>
    <li><a class="dropdown-item" href="../articles/epiworld_comparison.html">Comparison to epiworld</a></li>
    <li><a class="dropdown-item" href="../articles/hildale_and_colorado_city.html">City Population Data: Measles Outbreak Modeling Comparison</a></li>
    <li><a class="dropdown-item" href="../articles/measles_agemodel.html">Measles Age-Structured Model</a></li>
    <li><a class="dropdown-item" href="../articles/measles_example.html">Measles Outbreak Example</a></li>
    <li><a class="dropdown-item" href="../articles/measles_example2.html">Measles Outbreak Example 2</a></li>
    <li><a class="dropdown-item" href="../articles/run_model_on_command_line.html">Run Model in the console</a></li>
    <li><a class="dropdown-item" href="../articles/sensitivity_analysis.html">Sensitivity Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/utah_census_comparison.html">Utah Census Data: Measles Outbreak Modeling Comparison</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Contact Matrix Examples</h1>
            
      

      <div class="d-none name"><code>contact_matrix_examples.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://epiforesite.github.io/multigroup-vaccine/">multigroup.vaccine</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/epiforecasts/socialmixr" class="external-link">socialmixr</a></span><span class="op">)</span></span></code></pre></div>
<p>Set up age groups:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># under 1, 1-4, 5-11, 12-13, 14-17, 18-24, 25-44, 45-69, 70 plus</span></span>
<span><span class="va">agelims</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">5</span>, <span class="fl">12</span>, <span class="fl">14</span>, <span class="fl">18</span>, <span class="fl">25</span>, <span class="fl">45</span>, <span class="fl">70</span><span class="op">)</span></span>
<span><span class="va">agepops</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">400</span>, <span class="fl">700</span>, <span class="fl">200</span>, <span class="fl">400</span>, <span class="fl">700</span>, <span class="fl">2000</span>, <span class="fl">2400</span>, <span class="fl">1000</span><span class="op">)</span></span></code></pre></div>
<p>Generate contact matrix using Polymod data:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cmp</span> <span class="op">&lt;-</span> <span class="fu">multigroup.vaccine</span><span class="fu">:::</span><span class="fu"><a href="../reference/contactMatrixPolymod.html">contactMatrixPolymod</a></span><span class="op">(</span><span class="va">agelims</span>, <span class="va">agepops</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">cmp</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt;          contact.age.group</span></span>
<span><span class="co">#&gt; age.group under1 1to4 5to11 12to13 14to17 18to24 25to44 45to69  70+</span></span>
<span><span class="co">#&gt;    under1   0.42 0.72  0.57   0.09   0.21   0.32   2.11   1.14 0.13</span></span>
<span><span class="co">#&gt;    1to4     0.18 2.98  1.52   0.16   0.24   0.49   3.28   1.89 0.35</span></span>
<span><span class="co">#&gt;    5to11    0.08 0.87  8.79   0.82   0.46   0.46   3.35   1.88 0.37</span></span>
<span><span class="co">#&gt;    12to13   0.04 0.32  2.86   7.98   2.50   0.57   2.77   2.22 0.47</span></span>
<span><span class="co">#&gt;    14to17   0.05 0.24  0.80   1.25   9.67   2.21   2.71   2.51 0.37</span></span>
<span><span class="co">#&gt;    18to24   0.05 0.28  0.46   0.16   1.26   5.72   3.68   2.87 0.37</span></span>
<span><span class="co">#&gt;    25to44   0.11 0.66  1.17   0.28   0.54   1.29   5.72   3.83 0.61</span></span>
<span><span class="co">#&gt;    45to69   0.05 0.32  0.55   0.18   0.42   0.84   3.20   4.27 0.96</span></span>
<span><span class="co">#&gt;    70+      0.01 0.14  0.26   0.09   0.15   0.26   1.22   2.30 1.57</span></span></code></pre></div>
<p>The sum of each row represents the relative overall contact rate of
each group:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">cmp</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; under1   1to4  5to11 12to13 14to17 18to24 25to44 45to69    70+ </span></span>
<span><span class="co">#&gt;   5.72  11.11  17.09  19.74  19.82  14.86  14.20  10.78   6.01</span></span></code></pre></div>
<p>Those row sums can be factored out to generate the fraction of each
group’s contacts that are with each group: The sum of each row
represents the relative overall contact rate of each group:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">cmp</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">cmp</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt;          contact.age.group</span></span>
<span><span class="co">#&gt; age.group under1 1to4 5to11 12to13 14to17 18to24 25to44 45to69  70+</span></span>
<span><span class="co">#&gt;    under1   0.07 0.13  0.10   0.02   0.04   0.06   0.37   0.20 0.02</span></span>
<span><span class="co">#&gt;    1to4     0.02 0.27  0.14   0.01   0.02   0.04   0.29   0.17 0.03</span></span>
<span><span class="co">#&gt;    5to11    0.00 0.05  0.51   0.05   0.03   0.03   0.20   0.11 0.02</span></span>
<span><span class="co">#&gt;    12to13   0.00 0.02  0.14   0.40   0.13   0.03   0.14   0.11 0.02</span></span>
<span><span class="co">#&gt;    14to17   0.00 0.01  0.04   0.06   0.49   0.11   0.14   0.13 0.02</span></span>
<span><span class="co">#&gt;    18to24   0.00 0.02  0.03   0.01   0.08   0.38   0.25   0.19 0.03</span></span>
<span><span class="co">#&gt;    25to44   0.01 0.05  0.08   0.02   0.04   0.09   0.40   0.27 0.04</span></span>
<span><span class="co">#&gt;    45to69   0.00 0.03  0.05   0.02   0.04   0.08   0.30   0.40 0.09</span></span>
<span><span class="co">#&gt;    70+      0.00 0.02  0.04   0.02   0.02   0.04   0.20   0.38 0.26</span></span></code></pre></div>
<p>Now we split the age groups for elementary school (5-11), middle
school (12-13), and high school (18-24) into two schools each:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">schoolagegroups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">schoolpops</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">350</span>, <span class="fl">350</span>, <span class="fl">100</span>, <span class="fl">100</span>, <span class="fl">200</span>, <span class="fl">200</span><span class="op">)</span></span></code></pre></div>
<p>We can access the Polymod data to specify the number of contacts that
occurred at school:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cmAll</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://epiforecasts.io/socialmixr/reference/contact_matrix.html" class="external-link">contact_matrix</a></span><span class="op">(</span><span class="fu">socialmixr</span><span class="fu">::</span><span class="va"><a href="https://epiforecasts.io/socialmixr/reference/polymod.html" class="external-link">polymod</a></span>, age.limits <span class="op">=</span> <span class="va">agelims</span><span class="op">)</span><span class="op">$</span><span class="va">matrix</span></span>
<span><span class="co">#&gt; Removing participants without age information. To change this behaviour, set the 'missing.participant.age' option</span></span>
<span><span class="co">#&gt; Removing participants that have contacts without age information. To change this behaviour, set the 'missing.contact.age' option</span></span>
<span><span class="va">cmSchool</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://epiforecasts.io/socialmixr/reference/contact_matrix.html" class="external-link">contact_matrix</a></span><span class="op">(</span><span class="fu">socialmixr</span><span class="fu">::</span><span class="va"><a href="https://epiforecasts.io/socialmixr/reference/polymod.html" class="external-link">polymod</a></span>, age.limits <span class="op">=</span> <span class="va">agelims</span>, filter <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>cnt_school <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">matrix</span></span>
<span><span class="co">#&gt; Removing participants without age information. To change this behaviour, set the 'missing.participant.age' option</span></span>
<span><span class="co">#&gt; Removing participants that have contacts without age information. To change this behaviour, set the 'missing.contact.age' option</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">cmAll</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt;          contact.age.group</span></span>
<span><span class="co">#&gt; age.group [0,1) [1,5) [5,12) [12,14) [14,18) [18,25) [25,45) [45,70)  70+</span></span>
<span><span class="co">#&gt;   [0,1)    0.33  0.83   0.75    0.10    0.33    0.55    3.72    1.82 0.16</span></span>
<span><span class="co">#&gt;   [1,5)    0.07  2.34   1.38    0.19    0.25    0.51    3.62    1.81 0.32</span></span>
<span><span class="co">#&gt;   [5,12)   0.03  0.64   7.43    0.86    0.45    0.44    3.68    1.76 0.30</span></span>
<span><span class="co">#&gt;   [12,14)  0.03  0.17   1.99    7.14    2.47    0.63    3.35    2.03 0.35</span></span>
<span><span class="co">#&gt;   [14,18)  0.01  0.17   0.65    1.07    9.10    2.11    2.98    2.15 0.21</span></span>
<span><span class="co">#&gt;   [18,25)  0.01  0.21   0.41    0.13    1.22    5.64    4.14    2.63 0.29</span></span>
<span><span class="co">#&gt;   [25,45)  0.04  0.53   1.03    0.23    0.53    1.29    6.55    3.52 0.44</span></span>
<span><span class="co">#&gt;   [45,70)  0.02  0.26   0.50    0.18    0.46    0.91    4.01    4.34 0.74</span></span>
<span><span class="co">#&gt;   70+      0.01  0.11   0.25    0.10    0.20    0.31    1.72    2.75 1.48</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">cmSchool</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt;          contact.age.group</span></span>
<span><span class="co">#&gt; age.group [0,1) [1,5) [5,12) [12,14) [14,18) [18,25) [25,45) [45,70)  70+</span></span>
<span><span class="co">#&gt;   [0,1)    0.14  0.09   0.03    0.00    0.14    0.02    0.31    0.01 0.00</span></span>
<span><span class="co">#&gt;   [1,5)    0.01  1.45   0.43    0.02    0.02    0.02    0.47    0.18 0.01</span></span>
<span><span class="co">#&gt;   [5,12)   0.00  0.18   5.17    0.40    0.05    0.07    0.72    0.40 0.00</span></span>
<span><span class="co">#&gt;   [12,14)  0.00  0.01   0.62    5.57    1.38    0.07    0.86    0.48 0.01</span></span>
<span><span class="co">#&gt;   [14,18)  0.01  0.03   0.07    0.46    6.21    0.64    0.76    0.52 0.00</span></span>
<span><span class="co">#&gt;   [18,25)  0.00  0.03   0.04    0.01    0.42    2.02    0.36    0.20 0.00</span></span>
<span><span class="co">#&gt;   [25,45)  0.00  0.05   0.18    0.02    0.07    0.10    0.27    0.09 0.00</span></span>
<span><span class="co">#&gt;   [45,70)  0.00  0.06   0.15    0.04    0.12    0.05    0.11    0.10 0.01</span></span>
<span><span class="co">#&gt;   70+      0.00  0.00   0.01    0.00    0.01    0.00    0.00    0.01 0.00</span></span></code></pre></div>
<p>Based on this we assume that 70% of a student’s within-age-group
contacts occur at their own school:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">schportion</span> <span class="op">&lt;-</span> <span class="fl">0.70</span></span></code></pre></div>
<p>Now we build a new matrix using the
<code><a href="../reference/contactMatrixAgeSchool.html">contactMatrixAgeSchool()</a></code> function:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cmps</span> <span class="op">&lt;-</span> <span class="fu">multigroup.vaccine</span><span class="fu">:::</span><span class="fu"><a href="../reference/contactMatrixAgeSchool.html">contactMatrixAgeSchool</a></span><span class="op">(</span><span class="va">agelims</span>, <span class="va">agepops</span>, <span class="va">schoolagegroups</span>, <span class="va">schoolpops</span>, <span class="va">schportion</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">cmp</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt;          contact.age.group</span></span>
<span><span class="co">#&gt; age.group under1 1to4 5to11 12to13 14to17 18to24 25to44 45to69  70+</span></span>
<span><span class="co">#&gt;    under1   0.42 0.72  0.57   0.09   0.21   0.32   2.11   1.14 0.13</span></span>
<span><span class="co">#&gt;    1to4     0.18 2.98  1.52   0.16   0.24   0.49   3.28   1.89 0.35</span></span>
<span><span class="co">#&gt;    5to11    0.08 0.87  8.79   0.82   0.46   0.46   3.35   1.88 0.37</span></span>
<span><span class="co">#&gt;    12to13   0.04 0.32  2.86   7.98   2.50   0.57   2.77   2.22 0.47</span></span>
<span><span class="co">#&gt;    14to17   0.05 0.24  0.80   1.25   9.67   2.21   2.71   2.51 0.37</span></span>
<span><span class="co">#&gt;    18to24   0.05 0.28  0.46   0.16   1.26   5.72   3.68   2.87 0.37</span></span>
<span><span class="co">#&gt;    25to44   0.11 0.66  1.17   0.28   0.54   1.29   5.72   3.83 0.61</span></span>
<span><span class="co">#&gt;    45to69   0.05 0.32  0.55   0.18   0.42   0.84   3.20   4.27 0.96</span></span>
<span><span class="co">#&gt;    70+      0.01 0.14  0.26   0.09   0.15   0.26   1.22   2.30 1.57</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">cmps</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt;          under1 1to4 5to11s1 5to11s2 12to13s3 12to13s4 14to17s5 14to17s6 18to24</span></span>
<span><span class="co">#&gt; under1     0.42 0.72    0.28    0.28     0.04     0.04     0.11     0.11   0.32</span></span>
<span><span class="co">#&gt; 1to4       0.18 2.98    0.76    0.76     0.08     0.08     0.12     0.12   0.49</span></span>
<span><span class="co">#&gt; 5to11s1    0.08 0.87    7.47    1.32     0.41     0.41     0.23     0.23   0.46</span></span>
<span><span class="co">#&gt; 5to11s2    0.08 0.87    1.32    7.47     0.41     0.41     0.23     0.23   0.46</span></span>
<span><span class="co">#&gt; 12to13s3   0.04 0.32    1.43    1.43     6.79     1.20     1.25     1.25   0.57</span></span>
<span><span class="co">#&gt; 12to13s4   0.04 0.32    1.43    1.43     1.20     6.79     1.25     1.25   0.57</span></span>
<span><span class="co">#&gt; 14to17s5   0.05 0.24    0.40    0.40     0.63     0.63     8.22     1.45   2.21</span></span>
<span><span class="co">#&gt; 14to17s6   0.05 0.24    0.40    0.40     0.63     0.63     1.45     8.22   2.21</span></span>
<span><span class="co">#&gt; 18to24     0.05 0.28    0.23    0.23     0.08     0.08     0.63     0.63   5.72</span></span>
<span><span class="co">#&gt; 25to44     0.11 0.66    0.59    0.59     0.14     0.14     0.27     0.27   1.29</span></span>
<span><span class="co">#&gt; 45to69     0.05 0.32    0.27    0.27     0.09     0.09     0.21     0.21   0.84</span></span>
<span><span class="co">#&gt; 70+        0.01 0.14    0.13    0.13     0.05     0.05     0.07     0.07   0.26</span></span>
<span><span class="co">#&gt;          25to44 45to69  70+</span></span>
<span><span class="co">#&gt; under1     2.11   1.14 0.13</span></span>
<span><span class="co">#&gt; 1to4       3.28   1.89 0.35</span></span>
<span><span class="co">#&gt; 5to11s1    3.35   1.88 0.37</span></span>
<span><span class="co">#&gt; 5to11s2    3.35   1.88 0.37</span></span>
<span><span class="co">#&gt; 12to13s3   2.77   2.22 0.47</span></span>
<span><span class="co">#&gt; 12to13s4   2.77   2.22 0.47</span></span>
<span><span class="co">#&gt; 14to17s5   2.71   2.51 0.37</span></span>
<span><span class="co">#&gt; 14to17s6   2.71   2.51 0.37</span></span>
<span><span class="co">#&gt; 18to24     3.68   2.87 0.37</span></span>
<span><span class="co">#&gt; 25to44     5.72   3.83 0.61</span></span>
<span><span class="co">#&gt; 45to69     3.20   4.27 0.96</span></span>
<span><span class="co">#&gt; 70+        1.22   2.30 1.57</span></span></code></pre></div>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Damon Toth, Jake Wagoner, Centers for Disease Control and Prevention’s Center for Forecasting and Outbreak Analytics.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
