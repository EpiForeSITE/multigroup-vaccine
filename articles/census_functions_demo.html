<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Using Census Data Functions • multigroup.vaccine</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Using Census Data Functions">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">multigroup.vaccine</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Using Census Data Functions</h1>
            
      

      <div class="d-none name"><code>census_functions_demo.Rmd</code></div>
    </div>

    
    
<style type="text/css">
body {
  max-width: 1100px;
  margin: auto;
  padding: 1em;
}

table {
  width: 100%;
}
</style>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette demonstrates how to use the census data functions in
the <code>multigroup.vaccine</code> package. These functions allow you
to:</p>
<ol style="list-style-type: decimal">
<li>Look up state FIPS codes</li>
<li>List counties within a state</li>
<li>Retrieve population data by age groups</li>
<li>Retrieve city-level population data with flexible age grouping</li>
<li>Run outbreak models with easily accessible real-world data</li>
</ol>
<p>We’ll walk through a complete example using Utah county data.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://epiforesite.github.io/multigroup-vaccine/">multigroup.vaccine</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/epiforecasts/socialmixr" class="external-link">socialmixr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get the path to the included census data file</span></span>
<span><span class="va">census_csv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getCensusDataPath.html">getCensusDataPath</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="step-1-getting-state-fips-codes">Step 1: Getting State FIPS Codes<a class="anchor" aria-label="anchor" href="#step-1-getting-state-fips-codes"></a>
</h2>
<p>The <code><a href="../reference/getStateFIPS.html">getStateFIPS()</a></code> function looks up the FIPS code for a
state by name. FIPS codes are standardized identifiers used by the U.S.
Census Bureau.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get FIPS code for Utah</span></span>
<span><span class="va">utah_fips</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getStateFIPS.html">getStateFIPS</a></span><span class="op">(</span><span class="st">"Utah"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Utah FIPS code:"</span>, <span class="va">utah_fips</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Utah FIPS code: 49</span></span>
<span></span>
<span><span class="co"># You can also try other states</span></span>
<span><span class="va">california_fips</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getStateFIPS.html">getStateFIPS</a></span><span class="op">(</span><span class="st">"California"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"California FIPS code:"</span>, <span class="va">california_fips</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; California FIPS code: 06</span></span>
<span></span>
<span><span class="va">texas_fips</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getStateFIPS.html">getStateFIPS</a></span><span class="op">(</span><span class="st">"Texas"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Texas FIPS code:"</span>, <span class="va">texas_fips</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Texas FIPS code: 48</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="step-2-listing-counties">Step 2: Listing Counties<a class="anchor" aria-label="anchor" href="#step-2-listing-counties"></a>
</h2>
<p>The <code><a href="../reference/listCounties.html">listCounties()</a></code> function returns all counties in a
state. This is useful for exploring available data.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># List all counties in Utah</span></span>
<span><span class="va">utah_counties</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/listCounties.html">listCounties</a></span><span class="op">(</span></span>
<span>  state_fips <span class="op">=</span> <span class="va">utah_fips</span>,</span>
<span>  csv_path <span class="op">=</span> <span class="va">census_csv</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Counties in Utah:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Counties in Utah:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">utah_counties</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "Beaver County"     "Box Elder County"  "Cache County"     </span></span>
<span><span class="co">#&gt;  [4] "Carbon County"     "Daggett County"    "Davis County"     </span></span>
<span><span class="co">#&gt;  [7] "Duchesne County"   "Emery County"      "Garfield County"  </span></span>
<span><span class="co">#&gt; [10] "Grand County"      "Iron County"       "Juab County"      </span></span>
<span><span class="co">#&gt; [13] "Kane County"       "Millard County"    "Morgan County"    </span></span>
<span><span class="co">#&gt; [16] "Piute County"      "Rich County"       "Salt Lake County" </span></span>
<span><span class="co">#&gt; [19] "San Juan County"   "Sanpete County"    "Sevier County"    </span></span>
<span><span class="co">#&gt; [22] "Summit County"     "Tooele County"     "Uintah County"    </span></span>
<span><span class="co">#&gt; [25] "Utah County"       "Wasatch County"    "Washington County"</span></span>
<span><span class="co">#&gt; [28] "Wayne County"      "Weber County"</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nTotal number of counties:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">utah_counties</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Total number of counties: 29</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="step-3-retrieving-population-data">Step 3: Retrieving Population Data<a class="anchor" aria-label="anchor" href="#step-3-retrieving-population-data"></a>
</h2>
<p>The <code><a href="../reference/getCensusData.html">getCensusData()</a></code> function retrieves population data
for a specific county, organized by age groups.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define age groups for analysis</span></span>
<span><span class="co"># These represent: 0-4, 5-11, 12-17, 18-24, 25-44, 45-64, 65+</span></span>
<span><span class="va">age_limits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span>, <span class="fl">12</span>, <span class="fl">18</span>, <span class="fl">25</span>, <span class="fl">45</span>, <span class="fl">65</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get data for Washington County, Utah</span></span>
<span><span class="va">washington_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getCensusData.html">getCensusData</a></span><span class="op">(</span></span>
<span>  state_fips <span class="op">=</span> <span class="va">utah_fips</span>,</span>
<span>  county_name <span class="op">=</span> <span class="st">"Washington County"</span>,</span>
<span>  year <span class="op">=</span> <span class="fl">2024</span>,</span>
<span>  age_groups <span class="op">=</span> <span class="va">age_limits</span>,</span>
<span>  csv_path <span class="op">=</span> <span class="va">census_csv</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"County:"</span>, <span class="va">washington_data</span><span class="op">$</span><span class="va">county</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; County: Washington County</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Year:"</span>, <span class="va">washington_data</span><span class="op">$</span><span class="va">year</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Year: 2024</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Total population:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="va">washington_data</span><span class="op">$</span><span class="va">total_pop</span>, big.mark <span class="op">=</span> <span class="st">","</span><span class="op">)</span>, <span class="st">"\n\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Total population: 207,943</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Age distribution:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Age distribution:</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">washington_data</span><span class="op">$</span><span class="va">age_labels</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">pct</span> <span class="op">&lt;-</span> <span class="fl">100</span> <span class="op">*</span> <span class="va">washington_data</span><span class="op">$</span><span class="va">age_pops</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">/</span> <span class="va">washington_data</span><span class="op">$</span><span class="va">total_pop</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  %s: %s (%.1f%%)\n"</span>,</span>
<span>              <span class="va">washington_data</span><span class="op">$</span><span class="va">age_labels</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,</span>
<span>              <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="va">washington_data</span><span class="op">$</span><span class="va">age_pops</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, big.mark <span class="op">=</span> <span class="st">","</span><span class="op">)</span>,</span>
<span>              <span class="va">pct</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt;   0to4: 11,950 (5.7%)</span></span>
<span><span class="co">#&gt;   5to11: 18,808 (9.0%)</span></span>
<span><span class="co">#&gt;   12to17: 18,446 (8.9%)</span></span>
<span><span class="co">#&gt;   18to24: 19,948 (9.6%)</span></span>
<span><span class="co">#&gt;   25to44: 49,399 (23.8%)</span></span>
<span><span class="co">#&gt;   45to64: 42,661 (20.5%)</span></span>
<span><span class="co">#&gt;   65plus: 46,731 (22.5%)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="step-4-visualizing-age-distribution">Step 4: Visualizing Age Distribution<a class="anchor" aria-label="anchor" href="#step-4-visualizing-age-distribution"></a>
</h2>
<p>Let’s visualize the age distribution to better understand the
population structure.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a bar plot of age distribution</span></span>
<span><span class="va">age_percentages</span> <span class="op">&lt;-</span> <span class="fl">100</span> <span class="op">*</span> <span class="va">washington_data</span><span class="op">$</span><span class="va">age_pops</span> <span class="op">/</span> <span class="va">washington_data</span><span class="op">$</span><span class="va">total_pop</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="va">age_percentages</span>,</span>
<span>        names.arg <span class="op">=</span> <span class="va">washington_data</span><span class="op">$</span><span class="va">age_labels</span>,</span>
<span>        main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Age Distribution -"</span>, <span class="va">washington_data</span><span class="op">$</span><span class="va">county</span><span class="op">)</span>,</span>
<span>        xlab <span class="op">=</span> <span class="st">"Age Group"</span>,</span>
<span>        ylab <span class="op">=</span> <span class="st">"Percentage of Population"</span>,</span>
<span>        col <span class="op">=</span> <span class="st">"steelblue"</span>,</span>
<span>        las <span class="op">=</span> <span class="fl">2</span>,</span>
<span>        ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">age_percentages</span><span class="op">)</span> <span class="op">*</span> <span class="fl">1.1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add percentage labels on top of bars</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">age_percentages</span><span class="op">)</span> <span class="op">*</span> <span class="fl">1.2</span> <span class="op">-</span> <span class="fl">0.5</span>,</span>
<span>     y <span class="op">=</span> <span class="va">age_percentages</span> <span class="op">+</span> <span class="fl">1</span>,</span>
<span>     labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%.1f%%"</span>, <span class="va">age_percentages</span><span class="op">)</span>,</span>
<span>     pos <span class="op">=</span> <span class="fl">3</span>,</span>
<span>     cex <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span></code></pre></div>
<p><img src="census_functions_demo_files/figure-html/plot-age-distribution-1.png" class="r-plt" alt="Bar chart showing age distribution percentages for Washington County, Utah. Each bar represents an age group with percentage of total population labeled above." width="960"></p>
</div>
<div class="section level2">
<h2 id="step-5-comparing-multiple-counties">Step 5: Comparing Multiple Counties<a class="anchor" aria-label="anchor" href="#step-5-comparing-multiple-counties"></a>
</h2>
<p>Let’s compare the age distributions of three different Utah
counties.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get data for three counties</span></span>
<span><span class="va">counties_to_compare</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Salt Lake County"</span>, <span class="st">"Utah County"</span>, <span class="st">"Washington County"</span><span class="op">)</span></span>
<span><span class="va">county_data_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">county</span> <span class="kw">in</span> <span class="va">counties_to_compare</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">county_data_list</span><span class="op">[[</span><span class="va">county</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getCensusData.html">getCensusData</a></span><span class="op">(</span></span>
<span>    state_fips <span class="op">=</span> <span class="va">utah_fips</span>,</span>
<span>    county_name <span class="op">=</span> <span class="va">county</span>,</span>
<span>    year <span class="op">=</span> <span class="fl">2024</span>,</span>
<span>    age_groups <span class="op">=</span> <span class="va">age_limits</span>,</span>
<span>    csv_path <span class="op">=</span> <span class="va">census_csv</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Create comparison matrix</span></span>
<span><span class="va">comparison_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">counties_to_compare</span><span class="op">)</span>, </span>
<span>                            ncol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">age_limits</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">comparison_matrix</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">washington_data</span><span class="op">$</span><span class="va">age_labels</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">comparison_matrix</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Salt Lake"</span>, <span class="st">"Utah"</span>, <span class="st">"Washington"</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">counties_to_compare</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">county_name</span> <span class="op">&lt;-</span> <span class="va">counties_to_compare</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>  <span class="va">data</span> <span class="op">&lt;-</span> <span class="va">county_data_list</span><span class="op">[[</span><span class="va">county_name</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">comparison_matrix</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">100</span> <span class="op">*</span> <span class="va">data</span><span class="op">$</span><span class="va">age_pops</span> <span class="op">/</span> <span class="va">data</span><span class="op">$</span><span class="va">total_pop</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Plot comparison</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="va">comparison_matrix</span>,</span>
<span>        beside <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        main <span class="op">=</span> <span class="st">"Age Distribution Comparison Across Utah Counties"</span>,</span>
<span>        xlab <span class="op">=</span> <span class="st">"Age Group"</span>,</span>
<span>        ylab <span class="op">=</span> <span class="st">"Percentage of Population"</span>,</span>
<span>        col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"coral"</span>, <span class="st">"steelblue"</span>, <span class="st">"lightgreen"</span><span class="op">)</span>,</span>
<span>        legend.text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">comparison_matrix</span><span class="op">)</span>,</span>
<span>        args.legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"topright"</span>, bty <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span>,</span>
<span>        las <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="census_functions_demo_files/figure-html/compare-counties-1.png" class="r-plt" alt="Side-by-side bar chart comparing age distribution percentages across Salt Lake County (coral), Utah County (steel blue), and Washington County (light green). Each age group shows three bars representing the three counties." width="960"></p>
</div>
<div class="section level2">
<h2 id="step-6-using-city-level-data-getcitydata">Step 6: Using City-Level Data (getCityData)<a class="anchor" aria-label="anchor" href="#step-6-using-city-level-data-getcitydata"></a>
</h2>
<p>In addition to census data, the package includes functions to work
with city-level population data from ACS (American Community Survey)
estimates. Let’s demonstrate using Hildale, UT as an example.</p>
<div class="section level3">
<h3 id="example-1-default-5-year-age-groups">Example 1: Default 5-year Age Groups<a class="anchor" aria-label="anchor" href="#example-1-default-5-year-age-groups"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get path to Hildale data</span></span>
<span><span class="va">hildale_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"hildale_ut_2023.csv"</span>, package <span class="op">=</span> <span class="st">"multigroup.vaccine"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load with default 5-year age groups (0-4, 5-9, 10-14, ...)</span></span>
<span><span class="va">hildale_5yr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getCityData.html">getCityData</a></span><span class="op">(</span></span>
<span>  city_name <span class="op">=</span> <span class="st">"Hildale city, Utah"</span>,</span>
<span>  csv_path <span class="op">=</span> <span class="va">hildale_path</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Hildale, UT - 5-year Age Groups\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Hildale, UT - 5-year Age Groups</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"================================\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; ================================</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Total population:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="va">hildale_5yr</span><span class="op">$</span><span class="va">total_pop</span>, big.mark <span class="op">=</span> <span class="st">","</span><span class="op">)</span>, <span class="st">"\n\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Total population: 1,301</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Age distribution:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Age distribution:</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">hildale_5yr</span><span class="op">$</span><span class="va">age_labels</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">pct</span> <span class="op">&lt;-</span> <span class="fl">100</span> <span class="op">*</span> <span class="va">hildale_5yr</span><span class="op">$</span><span class="va">age_pops</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">/</span> <span class="va">hildale_5yr</span><span class="op">$</span><span class="va">total_pop</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  %s: %s (%.1f%%)\n"</span>,</span>
<span>              <span class="va">hildale_5yr</span><span class="op">$</span><span class="va">age_labels</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,</span>
<span>              <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="va">hildale_5yr</span><span class="op">$</span><span class="va">age_pops</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, big.mark <span class="op">=</span> <span class="st">","</span><span class="op">)</span>,</span>
<span>              <span class="va">pct</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt;   0to4: 57 (4.4%)</span></span>
<span><span class="co">#&gt;   5to9: 110 (8.5%)</span></span>
<span><span class="co">#&gt;   10to14: 181 (13.9%)</span></span>
<span><span class="co">#&gt;   15to19: 157 (12.1%)</span></span>
<span><span class="co">#&gt;   20to24: 134 (10.3%)</span></span>
<span><span class="co">#&gt;   25to29: 128 (9.8%)</span></span>
<span><span class="co">#&gt;   30to34: 55 (4.2%)</span></span>
<span><span class="co">#&gt;   35to39: 110 (8.5%)</span></span>
<span><span class="co">#&gt;   40to44: 59 (4.5%)</span></span>
<span><span class="co">#&gt;   45to49: 105 (8.1%)</span></span>
<span><span class="co">#&gt;   50to54: 64 (4.9%)</span></span>
<span><span class="co">#&gt;   55to59: 32 (2.5%)</span></span>
<span><span class="co">#&gt;   60to64: 29 (2.2%)</span></span>
<span><span class="co">#&gt;   65to69: 35 (2.7%)</span></span>
<span><span class="co">#&gt;   70to74: 0 (0.0%)</span></span>
<span><span class="co">#&gt;   75to79: 27 (2.1%)</span></span>
<span><span class="co">#&gt;   80to84: 18 (1.4%)</span></span>
<span><span class="co">#&gt;   85plus: 0 (0.0%)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="example-2-custom-age-groups-for-school-based-analysis">Example 2: Custom Age Groups for School-Based Analysis<a class="anchor" aria-label="anchor" href="#example-2-custom-age-groups-for-school-based-analysis"></a>
</h3>
<p>Now let’s use custom age groups that align with school levels:
pre-school (0-4), elementary (5-11), middle school (12-13), high school
(14-17), and adult groups.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define school-aligned age groups</span></span>
<span><span class="va">school_age_groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span>, <span class="fl">12</span>, <span class="fl">14</span>, <span class="fl">18</span>, <span class="fl">25</span>, <span class="fl">45</span>, <span class="fl">65</span><span class="op">)</span></span>
<span></span>
<span><span class="va">hildale_school</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getCityData.html">getCityData</a></span><span class="op">(</span></span>
<span>  city_name <span class="op">=</span> <span class="st">"Hildale city, Utah"</span>,</span>
<span>  csv_path <span class="op">=</span> <span class="va">hildale_path</span>,</span>
<span>  age_groups <span class="op">=</span> <span class="va">school_age_groups</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nHildale, UT - School-Aligned Age Groups\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Hildale, UT - School-Aligned Age Groups</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"========================================\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; ========================================</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Total population:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="va">hildale_school</span><span class="op">$</span><span class="va">total_pop</span>, big.mark <span class="op">=</span> <span class="st">","</span><span class="op">)</span>, <span class="st">"\n\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Total population: 1,301</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Age distribution:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Age distribution:</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">hildale_school</span><span class="op">$</span><span class="va">age_labels</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">pct</span> <span class="op">&lt;-</span> <span class="fl">100</span> <span class="op">*</span> <span class="va">hildale_school</span><span class="op">$</span><span class="va">age_pops</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">/</span> <span class="va">hildale_school</span><span class="op">$</span><span class="va">total_pop</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  %s: %s (%.1f%%)\n"</span>,</span>
<span>              <span class="va">hildale_school</span><span class="op">$</span><span class="va">age_labels</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,</span>
<span>              <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="va">hildale_school</span><span class="op">$</span><span class="va">age_pops</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, big.mark <span class="op">=</span> <span class="st">","</span><span class="op">)</span>,</span>
<span>              <span class="va">pct</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt;   0to4: 57 (4.4%)</span></span>
<span><span class="co">#&gt;   5to11: 182.4 (14.0%)</span></span>
<span><span class="co">#&gt;   12to13: 72.4 (5.6%)</span></span>
<span><span class="co">#&gt;   14to17: 130.4 (10.0%)</span></span>
<span><span class="co">#&gt;   18to24: 196.8 (15.1%)</span></span>
<span><span class="co">#&gt;   25to44: 352 (27.1%)</span></span>
<span><span class="co">#&gt;   45to64: 230 (17.7%)</span></span>
<span><span class="co">#&gt;   65plus: 80 (6.1%)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="visualizing-the-comparison">Visualizing the Comparison<a class="anchor" aria-label="anchor" href="#visualizing-the-comparison"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a comparison visualization</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot 5-year groups</span></span>
<span><span class="va">age_pct_5yr</span> <span class="op">&lt;-</span> <span class="fl">100</span> <span class="op">*</span> <span class="va">hildale_5yr</span><span class="op">$</span><span class="va">age_pops</span> <span class="op">/</span> <span class="va">hildale_5yr</span><span class="op">$</span><span class="va">total_pop</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="va">age_pct_5yr</span>,</span>
<span>        names.arg <span class="op">=</span> <span class="va">hildale_5yr</span><span class="op">$</span><span class="va">age_labels</span>,</span>
<span>        main <span class="op">=</span> <span class="st">"5-Year Age Groups"</span>,</span>
<span>        xlab <span class="op">=</span> <span class="st">"Age Group"</span>,</span>
<span>        ylab <span class="op">=</span> <span class="st">"% of Population"</span>,</span>
<span>        col <span class="op">=</span> <span class="st">"steelblue"</span>,</span>
<span>        las <span class="op">=</span> <span class="fl">2</span>,</span>
<span>        cex.names <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>        ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">age_pct_5yr</span><span class="op">)</span> <span class="op">*</span> <span class="fl">1.2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot school-aligned groups</span></span>
<span><span class="va">age_pct_school</span> <span class="op">&lt;-</span> <span class="fl">100</span> <span class="op">*</span> <span class="va">hildale_school</span><span class="op">$</span><span class="va">age_pops</span> <span class="op">/</span> <span class="va">hildale_school</span><span class="op">$</span><span class="va">total_pop</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="va">age_pct_school</span>,</span>
<span>        names.arg <span class="op">=</span> <span class="va">hildale_school</span><span class="op">$</span><span class="va">age_labels</span>,</span>
<span>        main <span class="op">=</span> <span class="st">"School-Aligned Age Groups"</span>,</span>
<span>        xlab <span class="op">=</span> <span class="st">"Age Group"</span>,</span>
<span>        ylab <span class="op">=</span> <span class="st">"% of Population"</span>,</span>
<span>        col <span class="op">=</span> <span class="st">"coral"</span>,</span>
<span>        las <span class="op">=</span> <span class="fl">2</span>,</span>
<span>        cex.names <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>        ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">age_pct_school</span><span class="op">)</span> <span class="op">*</span> <span class="fl">1.2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="census_functions_demo_files/figure-html/compare-aggregations-1.png" class="r-plt" alt="Two side-by-side bar charts comparing age grouping methods for Hildale, UT. Left panel shows 5-year age groups in steel blue. Right panel shows school-aligned age groups in coral. Both display percentage of population on y-axis." width="960"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>This demonstrates how <code><a href="../reference/getCityData.html">getCityData()</a></code> provides flexibility
in age grouping. The 5-year groups follow standard ACS categories, while
custom groups can be defined to match specific analysis needs (e.g.,
school grades, epidemiological contact patterns).</p>
</div>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>This vignette demonstrated the key population data functions in the
<code>multigroup.vaccine</code> package:</p>
<ol style="list-style-type: decimal">
<li>
<strong><code><a href="../reference/getStateFIPS.html">getStateFIPS()</a></code></strong>: Look up state FIPS
codes</li>
<li>
<strong><code><a href="../reference/listCounties.html">listCounties()</a></code></strong>: List all counties in a
state</li>
<li>
<strong><code><a href="../reference/getCensusData.html">getCensusData()</a></code></strong>: Retrieve county-level
population data by age groups from U.S. Census</li>
<li>
<strong><code><a href="../reference/getCityData.html">getCityData()</a></code></strong>: Retrieve city-level
population data from ACS with flexible age grouping</li>
</ol>
<p>These functions make it easy to work with real population data from
both census (county-level) and ACS (city-level) sources. The flexible
age grouping options allow you to structure data according to your
specific analysis needs, whether for epidemic modeling, demographic
analysis, or other applications. You can apply these same techniques to
any state and county in the United States.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Damon Toth, Jake Wagoner, Centers for Disease Control and Prevention’s Center for Forecasting and Outbreak Analytics.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
