# Measles Age-Structured Model

``` r
library(multigroup.vaccine)
library(socialmixr)
```

``` r
# under 1, 1-4, 5-11, 12-17, 18-24, 25-44, 45-69, 70 plus
agelims <- c(0, 1, 5, 12, 18, 25, 45, 70)
ageveff <- c(0.93, 0.93, rep(0.97, 5), 1)

agepops <- c(2354, 9418, 19835, 17001, 19219, 47701, 53956, 32842)
agecovr <- c(0, 0.83, 0.852, 0.879, 0.9, 0.925, 0.95, 1)
initgrp <- 6 # assume first case in 25-44 group

ot1 <- multigroup.vaccine:::getOutputTable(
  agelims = agelims,
  agepops = c(2354, 9418, 19835, 17001, 19219, 47701, 53956, 32842),
  agecovr = c(0, 0.83, 0.852, 0.879, 0.9, 0.925, 0.95, 1),
  ageveff = ageveff,
  initgrp = initgrp
)

print(as.data.frame(ot1), row.names = FALSE)
#>  R0       Rv pEscape escapeInfTot under1 1to4 5to11 12to17 18to24 25to44 45to69
#>  10 1.446787   0.168         7967    436  697  2024   1567    849   1524    871
#>  11 1.591466   0.212         9782    579  890  2355   1796   1076   1946   1140
#>  12 1.736145   0.283        11328    717 1060  2600   1962   1274   2321   1395
#>  13 1.880824   0.320        12650    847 1207  2784   2085   1444   2651   1631
#>  14 2.025502   0.366        13780    968 1335  2924   2177   1589   2939   1849
#>  15 2.170181   0.383        14751   1081 1445  3031   2247   1711   3189   2048
#>  16 2.314860   0.412        15588   1185 1539  3114   2301   1815   3405   2230
#>  17 2.459539   0.445        16310   1280 1619  3178   2342   1902   3593   2395
#>  18 2.604217   0.489        16937   1367 1689  3230   2375   1977   3755   2546
#>  70+
#>    0
#>    0
#>    0
#>    0
#>    0
#>    0
#>    0
#>    0
#>    0
```

``` r
ot2 <- multigroup.vaccine:::getOutputTable(
  agelims = agelims,
  agepops = c(11981, 47922, 86718, 77302, 120132, 199914, 136997, 38206),
  agecovr = c(0, 0.86, 0.899, 0.933, 0.95, 0.95, 0.95, 1),
  ageveff = ageveff,
  initgrp = initgrp
)

print(as.data.frame(ot2), row.names = FALSE)
#>  R0       Rv pEscape escapeInfTot under1 1to4 5to11 12to17 18to24 25to44 45to69
#>  10 1.030688   0.031         2715    204  315   793    515    289    426    172
#>  11 1.133757   0.083        10999    909 1343  2986   1946   1243   1817    754
#>  12 1.236826   0.118        18265   1635 2311  4643   3033   2157   3148   1337
#>  13 1.339895   0.162        24630   2358 3196  5910   3868   3002   4391   1906
#>  14 1.442964   0.228        30202   3060 3987  6890   4515   3765   5531   2454
#>  15 1.546033   0.249        35077   3729 4685  7657   5023   4443   6564   2974
#>  16 1.649102   0.311        39344   4360 5296  8264   5426   5040   7494   3464
#>  17 1.752170   0.322        43085   4949 5827  8749   5749   5562   8326   3922
#>  18 1.855239   0.338        46370   5495 6288  9140   6011   6018   9069   4351
#>  70+
#>    0
#>    0
#>    0
#>    0
#>    0
#>    0
#>    0
#>    0
#>    0
```

``` r
ot3 <- multigroup.vaccine:::getOutputTable(
  agelims = agelims,
  agepops = c(14527, 58108, 114156, 106006, 118837, 367597, 310945, 95637),
  agecovr = c(0, 0.89, 0.949, 0.950, 0.95, 0.95, 0.95, 1),
  ageveff = ageveff,
  initgrp = initgrp
)

print(as.data.frame(ot3), row.names = FALSE)
#>  R0        Rv pEscape escapeInfTot under1 1to4 5to11 12to17 18to24 25to44
#>  10 0.8250284   0.000            0      0    0     0      0      0      0
#>  11 0.9075312   0.000            0      0    0     0      0      0      0
#>  12 0.9900340   0.000            0      0    0     0      0      0      0
#>  13 1.0725369   0.067         9983    847  965  1292   1608    971   2776
#>  14 1.1550397   0.132        20346   1830 2019  2553   2962   1986   5763
#>  15 1.2375426   0.172        29531   2784 2975  3592   3975   2885   8465
#>  16 1.3200454   0.204        37587   3686 3821  4441   4751   3669  10857
#>  17 1.4025482   0.255        44629   4525 4560  5136   5358   4349  12953
#>  18 1.4850511   0.283        50788   5299 5203  5709   5840   4937  14783
#>  45to69 70+
#>       0   0
#>       0   0
#>       0   0
#>    1523   0
#>    3233   0
#>    4855   0
#>    6362   0
#>    7748   0
#>    9016   0
```
