# multigroup.vaccine

## Overview

`multigroup.vaccine` models infectious disease dynamics in populations
with multiple distinct subgroups that have:

- Different vaccination rates
- Different vaccine effectiveness
- Differential contact patterns between and within groups

The package provides both an interactive Shiny dashboard and
programmatic R functions for epidemiological modeling and outbreak
forecasting.

## Installation

### From R-universe (Recommended)

``` r
install.packages("multigroup.vaccine", 
                 repos = "https://epiforesite.r-universe.dev")
```

### From GitHub

``` r
# install.packages("remotes")
remotes::install_github("EpiForeSITE/multigroup-vaccine")
```

### Dependencies

The package depends on the following R packages:

- **Imports**: `deSolve`, `graphics`, `shiny`, `stats`, `bslib` (\>=
  0.8.0), `htmltools`, `socialmixr`
- **Suggests**: `knitr`, `rmarkdown`, `testthat` (\>= 3.0.0), `ggplot2`,
  `epiworldR`

Note that some vignettes require `ggplot2` and other suggested packages.

## Quick Start

### Interactive Dashboard

Launch the Shiny dashboard for interactive modeling:

``` r
library(multigroup.vaccine)
run_my_app()
```

The dashboard models two distinct sub-populations with differential
within-group and across-group contact rates and different vaccination
adherence levels. See [Nguyen et
al. (2024)](https://doi.org/10.1016/j.jval.2024.03.039) for more details
on this modeling approach.

### Programmatic Usage

You can also use the package functions directly in R scripts. Here’s an
example of comparing populations with different vaccination rates:

#### Two-Group Population Comparison

``` r
# Compare populations with different vaccination rates
results <- getFinalSize(
  vacPortion = c(0.9, 0.3),      # 90% vs 30% vaccinated
  popSize = c(10000, 10000),      # Equal population sizes
  R0 = 15,                        # Basic reproduction number
  recoveryRate = 0.1,             # 1/recovery rate = 10 days
  relContact = 0.05,              # 5% contact between groups
  contactWithinGroup = c(0.8, 0.8), # 80% within-group contact
  relSusc = c(0.1, 1)            # 10% relative susceptibility if vaccinated
)

print(results)
```

## Features

- **Multi-group SIR modeling** with vaccination and variable contact
  rates
- **Age-structured population models** using census data
- **Contact matrix integration** via POLYMOD and custom matrices
- **Final outbreak size calculations** using both analytic and
  stochastic methods
- **Interactive Shiny dashboard** for scenario exploration
- **Real-world case studies** including measles outbreaks with census
  data

## Documentation

Comprehensive documentation and vignettes are available at:
**<https://epiforesite.github.io/multigroup-vaccine/>**

View all available vignettes:

``` r
browseVignettes("multigroup.vaccine")
```

## Core Functions

- [`getOutputTable()`](https://epiforesite.github.io/multigroup-vaccine/reference/getOutputTable.md):
  Run age-structured outbreak simulations with vaccination
- [`getFinalSize()`](https://epiforesite.github.io/multigroup-vaccine/reference/getFinalSize.md):
  Calculate final outbreak size for two-group populations
- [`getFinalSizeDist()`](https://epiforesite.github.io/multigroup-vaccine/reference/getFinalSizeDist.md):
  Stochastic outbreak simulations with distributional results
- [`transmissionRates()`](https://epiforesite.github.io/multigroup-vaccine/reference/transmissionRates.md):
  Calculate transmission rate matrices from R0 and contact patterns
- [`contactMatrixPolymod()`](https://epiforesite.github.io/multigroup-vaccine/reference/contactMatrixPolymod.md):
  Generate age-structured contact matrices from POLYMOD data
- [`getCensusData()`](https://epiforesite.github.io/multigroup-vaccine/reference/getCensusData.md):
  Download and process US Census Bureau population data
- [`run_my_app()`](https://epiforesite.github.io/multigroup-vaccine/reference/run_my_app.md):
  Launch the interactive Shiny dashboard

## Getting Help

- **Bug reports**: [GitHub
  Issues](https://github.com/EpiForeSITE/multigroup-vaccine/issues)
- **Documentation**: [Package
  website](https://epiforesite.github.io/multigroup-vaccine/)

## Citation

If you use this package in your research, please obtain citation
information in R:

``` r
citation("multigroup.vaccine")
```

### Development Setup

For local development:

``` r
# Clone the repository
# git clone https://github.com/EpiForeSITE/multigroup-vaccine.git

# Install development dependencies
install.packages(c("devtools", "roxygen2", "pkgdown", "lintr"))

# Load the package for development
devtools::load_all()

# Run tests
devtools::test()

# Check package
devtools::check()
```

## License

This project is licensed under the MIT License - see the
[LICENSE.md](https://epiforesite.github.io/multigroup-vaccine/LICENSE.md)
file for details.

## Acknowledgments

This package is part of the [EpiForeSITE software
ecosystem](https://github.com/EpiForeSITE/software) developed by the
ForeSITE Group at the University of Utah. Development was supported by
the Centers for Disease Control and Prevention’s Center for Forecasting
and Outbreak Analytics (Cooperative agreement CDC-RFA-FT-23-0069).

------------------------------------------------------------------------

**EpiForeSITE**: Epidemiological Forecasting and Scenario Modeling
Initiative for Translational Epidemiology

# Package index

## All functions

- [`UtahAgeCountyPop`](https://epiforesite.github.io/multigroup-vaccine/reference/UtahAgeCountyPop.md)
  : Population size by age group for counties in Utah
- [`aggregateByAgeGroups()`](https://epiforesite.github.io/multigroup-vaccine/reference/aggregateByAgeGroups.md)
  : Aggregate population counts into age groups
- [`contactMatrixAgeSchool()`](https://epiforesite.github.io/multigroup-vaccine/reference/contactMatrixAgeSchool.md)
  : Calculate a contact matrix for age groups and schools
- [`contactMatrixPolymod()`](https://epiforesite.github.io/multigroup-vaccine/reference/contactMatrixPolymod.md)
  : Calculate a contact matrix for age groups based on Polymod contact
  survey data
- [`contactMatrixPropPref()`](https://epiforesite.github.io/multigroup-vaccine/reference/contactMatrixPropPref.md)
  : Calculate group contact matrix with proportional mixing and
  preferential mixing within group
- [`finalsize()`](https://epiforesite.github.io/multigroup-vaccine/reference/finalsize.md)
  : Calculate final outbreak size or distribution of a multigroup
  transmission model for a given basic reproduction number,
  contact/transmission assumptions, and initial conditions
- [`getCensusData()`](https://epiforesite.github.io/multigroup-vaccine/reference/getCensusData.md)
  : Get Census Population Data by Age and County
- [`getCensusDataPath()`](https://epiforesite.github.io/multigroup-vaccine/reference/getCensusDataPath.md)
  : Get path to example census data file
- [`getCityData()`](https://epiforesite.github.io/multigroup-vaccine/reference/getCityData.md)
  : Get City Population Data by Age
- [`getFinalSize()`](https://epiforesite.github.io/multigroup-vaccine/reference/getFinalSize.md)
  : Calculate final size of outbreak: the total number of infections in
  each group
- [`getFinalSizeAnalytic()`](https://epiforesite.github.io/multigroup-vaccine/reference/getFinalSizeAnalytic.md)
  : Calculate final size of outbreak: the total number of infections in
  each group, by solving the analytic final size equation
- [`getFinalSizeDist()`](https://epiforesite.github.io/multigroup-vaccine/reference/getFinalSizeDist.md)
  : Estimate the distribution of final outbreak sizes by group using
  stochastic simulations of multi-group model
- [`getFinalSizeDistEscape()`](https://epiforesite.github.io/multigroup-vaccine/reference/getFinalSizeDistEscape.md)
  : Estimate the distribution of final outbreak sizes by group using a
  hybrid model: stochastic simulations for smaller-sized outbreaks and
  deterministic ordinary differential equation model for "escaped"
  outbreaks
- [`getFinalSizeODE()`](https://epiforesite.github.io/multigroup-vaccine/reference/getFinalSizeODE.md)
  : Calculate outbreak final size, the total number of infections in
  each group, by numerically solving the multi-group ordinary
  differential equation
- [`getOutputTable()`](https://epiforesite.github.io/multigroup-vaccine/reference/getOutputTable.md)
  : Generate Output Table for Vaccine Model Scenarios
- [`getSizeAtTime()`](https://epiforesite.github.io/multigroup-vaccine/reference/getSizeAtTime.md)
  : Calculate outbreak size at a given time
- [`getStateFIPS()`](https://epiforesite.github.io/multigroup-vaccine/reference/getStateFIPS.md)
  : Get state FIPS code by state name
- [`listCounties()`](https://epiforesite.github.io/multigroup-vaccine/reference/listCounties.md)
  : List available counties for a state
- [`odeSIR()`](https://epiforesite.github.io/multigroup-vaccine/reference/odeSIR.md)
  : Ordinary differential equation function for multi-group
  susceptible-infectious-removed (SIR) model used as "func" argument
  passed to the ode() function from deSolve package
- [`run_my_app()`](https://epiforesite.github.io/multigroup-vaccine/reference/run_my_app.md)
  : Runs the shiny app
- [`transmissionRates()`](https://epiforesite.github.io/multigroup-vaccine/reference/transmissionRates.md)
  : Calculate transmission rate matrix for multi-group model with
  specified R0
- [`vaxrepnum()`](https://epiforesite.github.io/multigroup-vaccine/reference/vaxrepnum.md)
  : Calculate reproduction number for a multigroup model with a given
  state of vaccination and immunity

# Articles

### All vignettes

- [Age distribution effect on
  \$R_0\$](https://epiforesite.github.io/multigroup-vaccine/articles/age_dist_R0.md):
- [Using Census Data
  Functions](https://epiforesite.github.io/multigroup-vaccine/articles/census_functions_demo.md):
- [Contact Matrix
  Examples](https://epiforesite.github.io/multigroup-vaccine/articles/contact_matrix_examples.md):
- [Comparison to
  epiworld](https://epiforesite.github.io/multigroup-vaccine/articles/epiworld_comparison.md):
- [Measles Age-Structured
  Model](https://epiforesite.github.io/multigroup-vaccine/articles/measles_agemodel.md):
- [Measles Outbreak
  Example](https://epiforesite.github.io/multigroup-vaccine/articles/measles_example.md):
- [Measles Outbreak Example
  2](https://epiforesite.github.io/multigroup-vaccine/articles/measles_example2.md):
- [Run Model in the
  console](https://epiforesite.github.io/multigroup-vaccine/articles/run_model_on_command_line.md):
- [Sensitivity
  Analysis](https://epiforesite.github.io/multigroup-vaccine/articles/sensitivity_analysis.md):
- [Short Creek model with age and school
  structure](https://epiforesite.github.io/multigroup-vaccine/articles/shortcreek_age_school.md):
