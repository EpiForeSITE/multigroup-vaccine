# multigroup.vaccine

## Overview

`multigroup.vaccine` models infectious disease dynamics in populations
with multiple distinct subgroups that can have:

- Different vaccination rates
- Different susceptibility and/or transmissibility characteristics
- Different contact rates and patterns between and within groups

The package provides both an interactive `shiny` dashboard for a simple
two-group example and programmatic R functions for epidemiological
modeling and outbreak forecasting.

## Installation

### From CRAN (recommended)(when available)

``` r
install.packages("multigroup.vaccine")
```

### From R-universe

``` r
install.packages("multigroup.vaccine", 
                 repos = "https://epiforesite.r-universe.dev")
```

### From GitHub

``` r
# install.packages("remotes")
remotes::install_github("EpiForeSITE/multigroup-vaccine")
```

### Dependencies

The package depends on the following R packages:

- **Imports**: `deSolve`, `graphics`, `shiny`, `stats`, `bslib` (\>=
  0.9.0), `htmltools`, `socialmixr`
- **Suggests**: `knitr`, `rmarkdown`, `testthat` (\>= 3.0.0)

## Quick Start

### Interactive Dashboard

Launch the `shiny` dashboard for interactive modeling:

``` r
library(multigroup.vaccine)
run_my_app()
```

The dashboard models two distinct sub-populations with differential
within-group and across-group contact rates and different vaccination
adherence levels. See [Nguyen et
al. (2024)](https://doi.org/10.1016/j.jval.2024.03.039) and [Duong et
al. (2026)](https://doi.org/10.1093/ofid/ofaf695.217) for more details
on this modeling approach.

### Programmatic Usage

You can also use the package functions directly in R scripts. Here’s an
example of comparing populations with different vaccination rates:

#### Two-Group Population Comparison

``` r
# Compare two populations with different vaccination rates
results <- finalsize(
  popsize = c(10000, 10000),         # Equal population sizes
  R0 = 2,                            # Basic reproduction number
  contactmatrix = matrix(1, 2, 2),   # Equal and symmetric group-to-group contact 
  relsusc = c(1, 1),                 # Equal group susceptibility per at-risk contact
  reltransm = c(1, 1),               # Equal group transmissibility per at-risk contact
  initR = c(0, 0),                   # Initially none previously infected & immune (R)
  initI = c(1, 0),                   # One initial infectious case (I) in first group
  initV = c(1000, 2000),             # Initial numbers immune by vaccination (V)
  method = "analytic"                # Solve for final size analytically
)
print(results)
```

For examples of other functions or more complex scenarios, see the
[package
vignettes](https://epiforesite.github.io/multigroup-vaccine/articles/index.html).

## Features

- **Multi-group SIR modeling** with vaccination and variable contact
  rates
- **Age-structured population models** using census data
- **Contact matrix integration** via POLYMOD-derived and custom matrices
- **Final outbreak size calculations** using both analytic and
  stochastic methods
- **Interactive `shiny` dashboard** for scenario exploration

## Documentation

Comprehensive documentation and vignettes are available at:
<https://epiforesite.github.io/multigroup-vaccine/>

View all available vignettes:

``` r
browseVignettes("multigroup.vaccine")
```

## Core Functions

- [`finalsize()`](https://epiforesite.github.io/multigroup-vaccine/reference/finalsize.md):
  Master function for final outbreak size calculations and simulations
- [`contactMatrixPropPref()`](https://epiforesite.github.io/multigroup-vaccine/reference/contactMatrixPropPref.md):
  Generate contact matrices from proportionate mixing and preferential
  contact assumptions
- [`contactMatrixPolymod()`](https://epiforesite.github.io/multigroup-vaccine/reference/contactMatrixPolymod.md):
  Generate age-structured contact matrices from POLYMOD data
- [`getCensusData()`](https://epiforesite.github.io/multigroup-vaccine/reference/getCensusData.md):
  Download and process US Census Bureau population data for age
  group-structured models
- [`run_my_app()`](https://epiforesite.github.io/multigroup-vaccine/reference/run_my_app.md):
  Launch the interactive `shiny` dashboard for a two-group model

## Getting Help

- **Bug reports**: [GitHub
  Issues](https://github.com/EpiForeSITE/multigroup-vaccine/issues)
- **Documentation**: [Package
  website](https://epiforesite.github.io/multigroup-vaccine/)

## Citation

If you use this package in your research, please obtain citation
information in R:

``` r
citation("multigroup.vaccine")
```

### Development Setup

For local development:

``` r
# Clone the repository
# git clone https://github.com/EpiForeSITE/multigroup-vaccine.git

# Install development dependencies
install.packages(c("devtools", "roxygen2", "pkgdown", "lintr"))

# Load the package for development
devtools::load_all()

# Run tests
devtools::test()

# Check package
devtools::check()
```

## License

This project is licensed under the MIT License - see the LICENSE.md file
for details.

## Acknowledgments

This package is part of the [EpiForeSITE software
ecosystem](https://github.com/EpiForeSITE/software) developed by the
ForeSITE Group at the University of Utah. Development was supported by
the Centers for Disease Control and Prevention’s Center for Forecasting
and Outbreak Analytics (Cooperative agreement CDC-RFA-FT-23-0069).

# Package index

## All functions

- [`aggregateByAgeGroups()`](https://epiforesite.github.io/multigroup-vaccine/reference/aggregateByAgeGroups.md)
  : Aggregate population counts into age groups
- [`contactMatrixAgeSchool()`](https://epiforesite.github.io/multigroup-vaccine/reference/contactMatrixAgeSchool.md)
  : Calculate a contact matrix for age groups and schools
- [`contactMatrixPolymod()`](https://epiforesite.github.io/multigroup-vaccine/reference/contactMatrixPolymod.md)
  : Calculate a contact matrix for age groups based on Polymod contact
  survey data
- [`contactMatrixPropPref()`](https://epiforesite.github.io/multigroup-vaccine/reference/contactMatrixPropPref.md)
  : Calculate group contact matrix with proportional mixing and
  preferential mixing within group
- [`finalsize()`](https://epiforesite.github.io/multigroup-vaccine/reference/finalsize.md)
  : Calculate final outbreak size or distribution of a multigroup
  transmission model for a given basic reproduction number,
  contact/transmission assumptions, and initial conditions
- [`getCensusData()`](https://epiforesite.github.io/multigroup-vaccine/reference/getCensusData.md)
  : Get Census Population Data by Age and County
- [`getCensusDataPath()`](https://epiforesite.github.io/multigroup-vaccine/reference/getCensusDataPath.md)
  : Get path to example census data file
- [`getCityData()`](https://epiforesite.github.io/multigroup-vaccine/reference/getCityData.md)
  : Get City Population Data by Age
- [`getFinalSizeAnalytic()`](https://epiforesite.github.io/multigroup-vaccine/reference/getFinalSizeAnalytic.md)
  : Calculate final size of outbreak: the total number of infections in
  each group, by solving the analytic final size equation
- [`getFinalSizeDist()`](https://epiforesite.github.io/multigroup-vaccine/reference/getFinalSizeDist.md)
  : Estimate the distribution of final outbreak sizes by group using
  stochastic simulations of multi-group model
- [`getFinalSizeDistEscape()`](https://epiforesite.github.io/multigroup-vaccine/reference/getFinalSizeDistEscape.md)
  : Estimate the distribution of final outbreak sizes by group using a
  hybrid model: stochastic simulations for smaller-sized outbreaks and
  deterministic ordinary differential equation model for "escaped"
  outbreaks
- [`getFinalSizeODE()`](https://epiforesite.github.io/multigroup-vaccine/reference/getFinalSizeODE.md)
  : Calculate outbreak final size, the total number of infections in
  each group, by numerically solving the multi-group ordinary
  differential equation
- [`getSizeAtTime()`](https://epiforesite.github.io/multigroup-vaccine/reference/getSizeAtTime.md)
  : Calculate outbreak size at a given time
- [`getStateFIPS()`](https://epiforesite.github.io/multigroup-vaccine/reference/getStateFIPS.md)
  : Get state FIPS code by state name
- [`listCounties()`](https://epiforesite.github.io/multigroup-vaccine/reference/listCounties.md)
  : List available counties for a state
- [`odeSIR()`](https://epiforesite.github.io/multigroup-vaccine/reference/odeSIR.md)
  : Ordinary differential equation function for multi-group
  susceptible-infectious-removed (SIR) model used as "func" argument
  passed to the ode() function from deSolve package
- [`run_my_app()`](https://epiforesite.github.io/multigroup-vaccine/reference/run_my_app.md)
  : Runs the shiny app
- [`transmissionRates()`](https://epiforesite.github.io/multigroup-vaccine/reference/transmissionRates.md)
  : Calculate transmission rate matrix for multi-group model with
  specified R0
- [`vaxrepnum()`](https://epiforesite.github.io/multigroup-vaccine/reference/vaxrepnum.md)
  : Calculate reproduction number for a multigroup model with a given
  state of vaccination and immunity

# Articles

### Tutorials

- [Using Census Data
  Functions](https://epiforesite.github.io/multigroup-vaccine/articles/census_functions_demo.md):
- [Contact Matrix
  Examples](https://epiforesite.github.io/multigroup-vaccine/articles/contact_matrix_examples.md):
- [Measles Age-Structured
  Model](https://epiforesite.github.io/multigroup-vaccine/articles/measles_agemodel.md):
- [Getting Started
  Example](https://epiforesite.github.io/multigroup-vaccine/articles/run_model_on_command_line.md):

### Experiments/Research

- [Age distribution effect on
  R0](https://epiforesite.github.io/multigroup-vaccine/articles/experiments/age_dist_R0.md):
- [Short Creek model with age and school
  structure](https://epiforesite.github.io/multigroup-vaccine/articles/experiments/shortcreek_age_school.md):
